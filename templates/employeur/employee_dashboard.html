{% extends 'employeur/base_employer.html' %}

{% block content %}
    <div class="flex flex-1 overflow-hidden">
        <main class="flex-1 overflow-y-auto p-8">
            <!-- Welcome Banner -->
            <div class="bg-gradient-to-r from-blue-50 to-cyan-50 p-8 mb-8 rounded-2xl relative overflow-hidden">
                <div class="absolute inset-0 opacity-10">
                    <div class="absolute top-0 right-0 w-64 h-64 bg-blue-300 rounded-full filter blur-3xl opacity-30 animate-pulse"></div>
                    <div class="absolute bottom-0 left-0 w-48 h-48 bg-blue-400 rounded-full filter blur-3xl opacity-30 animate-pulse"></div>
                </div>
                <div class="relative flex flex-col lg:flex-row lg:items-center">
                    <div class="lg:w-2/3">
                        <h1 class="text-3xl font-bold text-gray-800 mb-3">Bonjour, {{ user.first_name }} üëã</h1>
                        <p class="text-xl text-gray-600 max-w-2xl mb-6">
                            Vous avez <span
                                class="font-semibold text-employer">{{ stats.totalServices }} services</span> actifs.
                            Trouvez le prestataire id√©al pour vos besoins.
                        </p>
                        <div class="flex gap-4">
                            <a href="{% url "service_search" %}"
                               class="px-6 py-3.5 bg-employer hover:bg-blue-700 text-white rounded-xl font-semibold flex items-center transition shadow-md transform hover:scale-105">
                                <i class="fas fa-search mr-3"></i> Trouver un service
                            </a>
                            <a href="#create_request"
                               class="px-6 py-3.5 bg-white hover:bg-gray-50 text-gray-800 rounded-xl font-semibold flex items-center transition shadow-md transform hover:scale-105">
                                <i class="fas fa-plus mr-3"></i> Nouvelle demande
                            </a>
                        </div>
                    </div>
                    <div class="mt-8 lg:mt-0 lg:w-1/3 flex justify-center">
                        <img src="https://cdn-icons-png.flaticon.com/512/1067/1067566.png"
                             alt="Employer Illustration" class="w-64 floating">
                    </div>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- Services Card -->
                <div class="stats-card" style="--gradient-from: #0ea5e9; --gradient-to: #0284c7;">
                    <div class="p-6">
                        <div class="flex items-center">
                            <div class="w-14 h-14 rounded-2xl bg-blue-100 flex items-center justify-center">
                                <i class="fas fa-tasks text-employer text-2xl"></i>
                            </div>
                            <div class="ml-5">
                                <p class="text-sm text-gray-500">Services actifs</p>
                                <h3 class="text-3xl font-bold text-gray-800 mt-1">{{ stats.totalServices }}</h3>
                            </div>
                        </div>
                        <div class="mt-6 flex items-center">
                            <div class="px-3 py-1.5 bg-blue-100 text-employer rounded-full text-sm font-medium flex items-center">
                                <i class="fas fa-arrow-up mr-1.5 text-xs"></i> 18%
                            </div>
                            <span class="ml-3 text-sm text-gray-500">vs mois dernier</span>
                        </div>
                    </div>
                </div>

                <!-- Spending Card -->
                <div class="stats-card" style="--gradient-from: #10b981; --gradient-to: #059669;">
                    <div class="p-6">
                        <div class="flex items-center">
                            <div class="w-14 h-14 rounded-2xl bg-green-100 flex items-center justify-center">
                                <i class="fas fa-wallet text-green-600 text-2xl"></i>
                            </div>
                            <div class="ml-5">
                                <p class="text-sm text-gray-500">D√©penses mensuelles</p>
                                <h3 class="text-3xl font-bold text-gray-800 mt-1">{{ stats.monthlySpending }}</h3>
                            </div>
                        </div>
                        <div class="mt-6">
                            <div class="chart-container">
                                <div class="chart-bar" data-height="40"
                                     style="--bar-color: #0ea5e9; --bar-color-light: #bae6fd;"></div>
                                <div class="chart-bar" data-height="80"
                                     style="--bar-color: #0ea5e9; --bar-color-light: #bae6fd;"></div>
                                <div class="chart-bar" data-height="60"
                                     style="--bar-color: #0ea5e9; --bar-color-light: #bae6fd;"></div>
                                <div class="chart-bar" data-height="100"
                                     style="--bar-color: #0ea5e9; --bar-color-light: #bae6fd;"></div>
                                <div class="chart-bar" data-height="70"
                                     style="--bar-color: #0ea5e9; --bar-color-light: #bae6fd;"></div>
                                <div class="chart-bar" data-height="90"
                                     style="--bar-color: #0ea5e9; --bar-color-light: #bae6fd;"></div>
                                <div class="chart-bar" data-height="85"
                                     style="--bar-color: #0ea5e9; --bar-color-light: #bae6fd;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Requests Card -->
                <div class="stats-card" style="--gradient-from: #f59e0b; --gradient-to: #d97706;">
                    <div class="p-6">
                        <div class="flex items-center">
                            <div class="w-14 h-14 rounded-2xl bg-yellow-100 flex items-center justify-center">
                                <i class="fas fa-file-alt text-yellow-500 text-2xl"></i>
                            </div>
                            <div class="ml-5">
                                <p class="text-sm text-gray-500">Demandes en attente</p>
                                <h3 class="text-3xl font-bold text-gray-800 mt-1">{{ stats.pendingRequests }}</h3>
                            </div>
                        </div>
                        <div class="mt-6">
                            <div class="progress-bar">
                                <div class="progress-value bg-employer" style="--progress-value: 60%"></div>
                            </div>
                            <p class="text-xs text-gray-500 mt-2">Taux de r√©ponse: 85%</p>
                        </div>
                    </div>
                </div>

                <!-- Satisfaction Card -->
                <div class="stats-card" style="--gradient-from: #8b5cf6; --gradient-to: #7c3aed;">
                    <div class="p-6">
                        <div class="flex items-center">
                            <div class="w-14 h-14 rounded-2xl bg-purple-100 flex items-center justify-center">
                                <i class="fas fa-star text-purple-500 text-2xl"></i>
                            </div>
                            <div class="ml-5">
                                <p class="text-sm text-gray-500">Satisfaction</p>
                                <h3 class="text-3xl font-bold text-gray-800 mt-1">4.8/5</h3>
                            </div>
                        </div>
                        <div class="mt-6">
                            <div class="rating-stars" data-rating="4.8">
                                <div class="rating-fill"></div>
                            </div>
                            <span class="ml-2 text-gray-600">(42 avis)</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Services Categories -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Services populaires</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <template x-for="category in popularCategories" :key="category.id">
                        <div class="bg-white rounded-2xl p-5 text-center hover:shadow-lg transition cursor-pointer transform hover:-translate-y-1">
                            <div class="w-16 h-16 rounded-2xl bg-blue-100 flex items-center justify-center mx-auto mb-4">
                                <i :class="category.icon" class="text-employer text-2xl"></i>
                            </div>
                            <h3 class="font-semibold" x-text="category.name"></h3>
                            <p class="text-xs text-gray-500 mt-1" x-text="category.providers + '+ prestataires'"></p>
                        </div>
                    </template>
                </div>
            </div>

            <!-- Recommended Workers -->
            <div class="bg-white rounded-2xl shadow-sm p-7 mb-8">
                <div class="flex justify-between items-center mb-7">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-1">Prestataires recommand√©s</h2>
                        <p class="text-gray-500">D√©couvrez nos meilleurs travailleurs pr√®s de chez vous</p>
                    </div>
                    <div>
                        <a href="#handyman_list" class="text-base text-employer font-semibold flex items-center">
                            Voir plus <i class="fas fa-arrow-right ml-2 text-xs"></i>
                        </a>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <template x-for="worker in recommendedWorkers" :key="worker.id">
                        <div class="service-card">
                            <div class="h-48 relative overflow-hidden">
                                <img :src="worker.image"
                                     alt="Worker"
                                     class="w-full h-full object-cover transition-transform duration-500 hover:scale-110">
                                <div class="absolute top-4 right-4 bg-white/90 px-3 py-1.5 rounded-xl text-sm font-semibold flex items-center">
                                    <i class="fas fa-star text-yellow-500 mr-1.5"></i>
                                    <span x-text="worker.rating"></span>
                                </div>
                                <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/70 to-transparent p-4 text-white">
                                    <h3 class="font-bold text-lg" x-text="worker.name"></h3>
                                    <p class="text-sm" x-text="worker.profession"></p>
                                </div>
                            </div>
                            <div class="p-5">
                                <div class="flex items-center justify-between">
                                    <span class="text-lg font-bold" x-text="worker.price"></span>
                                    <button class="px-3 py-1.5 bg-employer text-white rounded-lg text-sm hover:bg-blue-700 transition">
                                        Contacter
                                    </button>
                                </div>
                                <div class="mt-4 flex justify-between">
                                    <a href="#" class="text-sm text-employer font-medium flex items-center">
                                        <i class="far fa-eye mr-1"></i> Voir profil
                                    </a>
                                    <button class="text-sm text-employer font-medium flex items-center">
                                        <i class="far fa-bookmark mr-1"></i> Enregistrer
                                    </button>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </div>

            <!-- Current Requests -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Active Requests -->
                <div class="bg-white rounded-2xl shadow-sm p-7">
                    <div class="flex justify-between items-center mb-7">
                        <h2 class="text-2xl font-bold text-gray-800">Mes demandes actives</h2>
                        <a href="#my_requests" class="text-base text-employer font-semibold flex items-center">
                            Voir tout <i class="fas fa-arrow-right ml-2 text-xs"></i>
                        </a>
                    </div>

                    <div class="space-y-5">
                        <template x-for="request in activeRequests" :key="request.id">
                            <div class="flex items-start p-5 bg-blue-50/50 rounded-2xl hover:bg-blue-100/30 transition">
                                <div class="flex-shrink-0 mr-5">
                                    <div class="w-14 h-14 rounded-2xl bg-employer/10 flex items-center justify-center">
                                        <i :class="request.icon" class="text-employer text-2xl"></i>
                                    </div>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="text-base font-semibold text-gray-900" x-text="request.title"></p>
                                    <p class="text-sm text-gray-500 mt-1" x-text="'Demand√© le ' + request.date"></p>
                                    <div class="mt-3 flex items-center text-sm text-gray-400">
                                        <i class="fas fa-user mr-2"></i>
                                        <span x-text="request.providers + ' prestataires int√©ress√©s'"></span>
                                    </div>
                                </div>
                                <div class="ml-4">
                                    <span class="px-3 py-1.5 bg-employer text-white text-xs font-medium rounded-full"
                                          x-text="request.status"></span>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Upcoming Services -->
                <div class="bg-white rounded-2xl shadow-sm p-7">
                    <div class="flex justify-between items-center mb-7">
                        <h2 class="text-2xl font-bold text-gray-800">Services √† venir</h2>
                        <a href="#employer_calendar" class="text-base text-employer font-semibold flex items-center">
                            Voir calendrier <i class="fas fa-arrow-right ml-2 text-xs"></i>
                        </a>
                    </div>

                    <div class="space-y-5">
                        <template x-for="service in upcomingServices" :key="service.id">
                            <div class="flex items-start p-5 bg-blue-50/50 rounded-2xl hover:bg-blue-100/30 transition">
                                <div class="flex-shrink-0 mr-5">
                                    <div class="w-14 h-14 rounded-2xl bg-employer/10 flex items-center justify-center">
                                        <i :class="service.icon" class="text-employer text-2xl"></i>
                                    </div>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="text-base font-semibold text-gray-900" x-text="service.title"></p>
                                    <p class="text-sm text-gray-500 mt-1" x-text="'Avec ' + service.provider"></p>
                                    <div class="mt-3 flex items-center text-sm text-gray-400">
                                        <i class="far fa-clock mr-2"></i>
                                        <span x-text="service.date"></span>
                                    </div>
                                </div>
                                <div class="ml-4">
                                    <span class="px-3 py-1.5 bg-employer text-white text-xs font-medium rounded-full"
                                          x-text="service.status"></span>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </main>
    </div>
{% endblock %}